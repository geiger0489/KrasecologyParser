<h2>KrasecologyParser</h2>Программа-парсер для получения данных с графиков <a href="http://www.highcharts.com/">highcharts</a> 
на сайте <a href="http://krasecology.ru/operative/air">http://krasecology.ru/operative/air</a>.

<h3>Установка</h3>
<ol>
<li>Скачать и установить интерпретатор <a href="https://www.python.org/ftp/python/3.4.3/python-3.4.3.msi">Python3.</a></li>
<li>Распаковать архив с парсером в любую удобную папку.</li>
<li>Запустить файл KrasecologyParser.py.</li>
<li>Следовать инструкциям.</li>
<li>Результат появится на рабочем столе.</li>
</ol>
<h3>Настройки парсера</h3><p>
Чтобы изменить настройки парсера необходимо изменить значения следующих переменных в KrasecologyParser.py:</p>
<ol>
<li><h5>TIME_ZONE = 7</h5><p>
Часовой пояс отражается на дате в колонке «Время измерения» во вкладке для каждого датчика.</p></li>
<li><h5>CURRENT_DATE_TIME = datetime.datetime.now()</li></h5>
<p>Настройку менять не следует. Возвращает текущее время запуска парсера. Записывается в шапку каждой из вкладок отчета и в название файла отчета.</p>
<li><h5>COL_WIDTH = 20</li></h5>
<p>Это значение задает ширину колонок в таблице эксель.</p>
<li><h5>DESKTOP_PATH = os.path.expanduser("~/Desktop/")</li></h5>
<p>После каждого запуска отчет с данными помещается на рабочий стол. Если это не устраивает, то нужно поменять значение данной переменной. Например:
DESKTOP_PATH = r'D:\MyFolder\MyFolder2'.  Отчет будет попадать в папку MyFolder2.</p>
<li><h5>CODING = 'utf-8'</li></h5>
<p>Кодировка сайта, менять если поменяется кодировка на сайте.</p>
<li><h5>DELAY = 0.5</li></h5>
<p>Интервал в секундах между запросами к сайту.</p>
<li><h5>INTERVAL = {1: 'day', 2: 'week'}
</li></h5>
<p>Настройка подлежит изменению только в случае изменений на сайте.</p>
<li><h5>PLACES = {<br>
1: 'Ачинск-Юго-Восточный',<br>
2: 'Красноярск-Северный',<br>
3: 'Красноярск-Березовка',<br>
4: 'Красноярск-Солнечный',<br>
5: 'Красноярск-Черемушки',<br>
6: 'Красноярск-Кубеково',<br>
}</li></h5>
<p>
Если на сайте добавятся новые посты, то парсер этого не поймет т.к. нет ссылки, которая давала бы такую информацию. Пост нужно добавить вручную в эту переменную.</p><p>Например:</p>
<center><p><code>7: 'Любое имя для поста'</code></p></center>
<p>Имя для поста из этой переменной используется как название вкладки в экселе.
Если нужно получить данные не по всем, а только по определенным постам, то нужно закомментировать ненужные посты знаком <code>#</code>.</p><p>Например, так будет сканироваться только Ачинский пост:</p>
<p>
<code>PLACES = {</code><br>
<code>1: 'Ачинск-Юго-Восточный',</code><br>
<code>#2: 'Красноярск-Северный',</code><br>
<code>#3: 'Красноярск-Березовка',</code><br>
<code>#4: 'Красноярск-Солнечный',</code><br>
<code>#5: 'Красноярск-Черемушки',</code><br>
<code>#6: 'Красноярск-Кубеково',</code><br>
<code>}</code>
</p>
<li><h5>PLACE_URL = 'http://krasecology.ru/Main/GetAirSensorList/%s'</li></h5>
<p>Адрес каждого поста со списком датчиков. Менять только если поменялось на сайте.</p>
<li><h5>SENSOR_URL = 'http://krasecology.ru/Main/GetAirSensorData/%s?timelap=%s'</li></h5>
<p>Адрес каждого датчика со значениями. Менять только если поменялось на сайте.</p>
Все вопросы присылайте на эл. почту: sashageiger@gmail.com</ol>
